#   y-ticks (no lables) on right scatter
#   y ticks on histos?
#   some marker for clipped y in histos?
#   X: (tried this, doesn't help; change filtering so gyre looks better, maybe get 100 k points or so?)
margin.scat <- function(stxl=6, stxr=2, sty=7, label.panels=TRUE){
# plot main fig with 2 side-by-side smooth-scatters and marginal histograms
# if stxl is NULL, omit left scatter/margin
opar <- par(mar=c(0.6,0.3,0.0,0.4),oma=c(3,4,0,0),tck=-.02); on.exit(par(opar))
# layout in 2 x 4 grid; '0's provide some spacing
if(!is.null(stxl)){
layout.mat <- matrix(c(1,0,2,0,4,0,5,3),nrow=2,byrow=T)
} else {
layout.mat <- matrix(c(0,0,1,0,0,0,3,2),nrow=2,byrow=T)
}
layout(layout.mat, widths=c(2,0.2,2,1),heights=c(1,2),
respect=matrix(rep(1,8),nrow=2,byrow=T))
# 1: upper left histo
if(!is.null(stxl)){
gamma.hist(stxl,compact=T, show.count.axis=T, panel.label=ifelse(label.panels,'A',''))
}
# 2: upper mid histo
gamma.hist(stxr,compact=T, show.count.axis=is.null(stxl), panel.label=ifelse(label.panels,'B',''))
# 3: lower right histo
gamma.hist(sty,rotate=T,compact=T, show.count.axis=T, panel.label=ifelse(label.panels,'C',''))
# axis labels
xl1 <- 'R' # paste('R (',colnames(nrfall)[stxl], ')',sep='')
xl2 <- 'R' # paste('R (',colnames(nrfall)[stxr], ')',sep='')
yl  <- 'R' # paste('R (',colnames(nrfall)[sty],  ')',sep='')
# 4: lower left scatter
if(!is.null(stxl)){
smoothScatter(nrfall[samp,stxl], nrfall[samp,sty], pch='.', cex=2, nrpoints=200,
transformation=xformer(20,.2,.03,0.33),
xlab=xl1, xlim=0:1, xaxp=c(0,1,2),
ylab=yl,  ylim=0:1, yaxp=c(0,1,2),xaxt='s',yaxt='s')
mtext(xl1,side=1, line=2.5, cex=.9)
mtext(yl, side=2, line=2.5, cex=.9)
if(label.panels){text(.10, .95, 'D', cex=1.5)}
}
# 5: lower mid scatter
#eplot(0:1,0:1)
smoothScatter(nrfall[samp,stxr], nrfall[samp,sty], pch='.', cex=2, nrpoints=200,
transformation=xformer(20,.2,.03,0.33),
xlab=xl2, xlim=0:1, xaxp=c(0,1,2),
ylab='',  ylim=0:1, yaxp=c(0,1,2),xaxt='s',yaxt=ifelse(is.null(stxl),'s','n'))
mtext(xl2, side=1, line=2.5, cex=.9)
if(is.null(stxl)){
mtext(yl, side=2, line=2.5, cex=.9)
}
if(label.panels){text(.10, .95, 'E', cex=1.5)}
}
12/87
setwd("~/Documents/g/projects/thaps/Thaps_7_strains/code/snpNB/scripts/larrys/paperfigs")
source('../../../R/wlr.R') # load util code; path relative this folder or sibling in scripts/larrys
setup.my.wd('paperfigs') # set working dir; UPDATE if this file moves, or if COPY/PASTE to new file
setup.my.knitr('Fig2-figs-knitr/') # knitr's "unnamed-chunk-nnn" figures
my.figs.dir  <- 'Fig2-figs-mine/'    # my named figures
generic.setup(my.figs.dir)
# frequently need to add figpath to file name
fpath <- function(base, suffix='.pdf', dir=my.figs.dir){
return(paste(dir, base, suffix, sep=''))
}
height.a <- 3.1
height.b <- 2.1
#pdf(fpath('Fig2.pdf'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE,oma=c(0,0,0,0),mar=c(3,3,1,1),tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a,height.b))
#\section{Setup and Draw Fig 2A}
#<<>>=
chr1.len <- genome.length.constants()$chr1.length  ## 3042585
chr1.len
load('Fig2A-data.rda') ## contains the "gap table" all.n.na
all.n.na
# Also load the desert tables:
# from svn+ssh://ceg1.ocean.washington.edu/var/svn/7_strains/trunk/code/snpNB/data
load('../../../data/des.rda')
names(des)[[6]] <- 'tp3367'  # override oldschool name
# Order of isolates, top-to-bottom in fig 2A:
strain.order <- c(7,1,2,5,4,3,6)
names(des)[strain.order]
#pdf(fpath('Fig2A-desert-distribution-figq'), width=6.5, height=2.1)
# full param list:
#draw.des.fig <- function(des, gap.tbl=NULL, width=chr1.len,
#                         draw.nondes=FALSE, min.desert=000, min.gap=width/3000,
#                         d.col='deepskyblue1', nd.col='white', gap.col='pink',
#                         row.spacing=50,row.separation=10, row.order=strain.order,
#                         chr='Chr1', xlab='Chromosome 1 Position (Mb)',
#                         panel.label=NA, twotone=NA){...}
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue')
#dev.off()
#@
#\section{Setup and Draw Fig 2B}
#<<>>=
load('../nc-snps/Fig2B-data.rda') # provides snp.rates.blob, needed by snp.rates.plot
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
#print(xx)
height.a <- 2.1
height.b <- 2.1
pdf(fpath('Fig2.pdf'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE,oma=c(0,0,0,0),mar=c(3,3,1,1),tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a,height.b))
#\section{Setup and Draw Fig 2A}
#<<>>=
chr1.len <- genome.length.constants()$chr1.length  ## 3042585
chr1.len
load('Fig2A-data.rda') ## contains the "gap table" all.n.na
all.n.na
# Also load the desert tables:
# from svn+ssh://ceg1.ocean.washington.edu/var/svn/7_strains/trunk/code/snpNB/data
load('../../../data/des.rda')
names(des)[[6]] <- 'tp3367'  # override oldschool name
# Order of isolates, top-to-bottom in fig 2A:
strain.order <- c(7,1,2,5,4,3,6)
names(des)[strain.order]
#pdf(fpath('Fig2A-desert-distribution-figq'), width=6.5, height=2.1)
# full param list:
#draw.des.fig <- function(des, gap.tbl=NULL, width=chr1.len,
#                         draw.nondes=FALSE, min.desert=000, min.gap=width/3000,
#                         d.col='deepskyblue1', nd.col='white', gap.col='pink',
#                         row.spacing=50,row.separation=10, row.order=strain.order,
#                         chr='Chr1', xlab='Chromosome 1 Position (Mb)',
#                         panel.label=NA, twotone=NA){...}
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
#dev.off()
#@
#\section{Setup and Draw Fig 2B}
#<<>>=
load('../nc-snps/Fig2B-data.rda') # provides snp.rates.blob, needed by snp.rates.plot
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
#print(xx)
source('../../../R/wlr.R')
height.a <- 2.1
height.b <- 2.1
pdf(fpath('Fig2.pdf'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE,oma=c(0,0,0,0),mar=c(3,3,1,1),tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a,height.b))
#\section{Setup and Draw Fig 2A}
#<<>>=
chr1.len <- genome.length.constants()$chr1.length  ## 3042585
chr1.len
load('Fig2A-data.rda') ## contains the "gap table" all.n.na
all.n.na
# Also load the desert tables:
# from svn+ssh://ceg1.ocean.washington.edu/var/svn/7_strains/trunk/code/snpNB/data
load('../../../data/des.rda')
names(des)[[6]] <- 'tp3367'  # override oldschool name
# Order of isolates, top-to-bottom in fig 2A:
strain.order <- c(7,1,2,5,4,3,6)
names(des)[strain.order]
#pdf(fpath('Fig2A-desert-distribution-figq'), width=6.5, height=2.1)
# full param list:
#draw.des.fig <- function(des, gap.tbl=NULL, width=chr1.len,
#                         draw.nondes=FALSE, min.desert=000, min.gap=width/3000,
#                         d.col='deepskyblue1', nd.col='white', gap.col='pink',
#                         row.spacing=50,row.separation=10, row.order=strain.order,
#                         chr='Chr1', xlab='Chromosome 1 Position (Mb)',
#                         panel.label=NA, twotone=NA){...}
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
#dev.off()
#@
#\section{Setup and Draw Fig 2B}
#<<>>=
load('../nc-snps/Fig2B-data.rda') # provides snp.rates.blob, needed by snp.rates.plot
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
#print(xx)
height.a <- 2.1
height.b <- 2.1
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE,oma=c(0,0,0,0),mar=c(3,3,1,1),tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a,height.b))
#\section{Setup and Draw Fig 2A}
#<<>>=
chr1.len <- genome.length.constants()$chr1.length  ## 3042585
chr1.len
load('Fig2A-data.rda') ## contains the "gap table" all.n.na
all.n.na
# Also load the desert tables:
# from svn+ssh://ceg1.ocean.washington.edu/var/svn/7_strains/trunk/code/snpNB/data
load('../../../data/des.rda')
names(des)[[6]] <- 'tp3367'  # override oldschool name
# Order of isolates, top-to-bottom in fig 2A:
strain.order <- c(7,1,2,5,4,3,6)
names(des)[strain.order]
#pdf(fpath('Fig2A-desert-distribution-figq'), width=6.5, height=2.1)
# full param list:
#draw.des.fig <- function(des, gap.tbl=NULL, width=chr1.len,
#                         draw.nondes=FALSE, min.desert=000, min.gap=width/3000,
#                         d.col='deepskyblue1', nd.col='white', gap.col='pink',
#                         row.spacing=50,row.separation=10, row.order=strain.order,
#                         chr='Chr1', xlab='Chromosome 1 Position (Mb)',
#                         panel.label=NA, twotone=NA){...}
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
#dev.off()
#@
#\section{Setup and Draw Fig 2B}
#<<>>=
load('../nc-snps/Fig2B-data.rda') # provides snp.rates.blob, needed by snp.rates.plot
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
#print(xx)
source('../../../R/wlr.R')
source('../../../R/wlr.R')
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.8))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
source('../../../R/wlr.R')
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.8))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.9, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.9, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.9, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
source('../../../R/wlr.R') # load util code; path relative this folder or sibling in scripts/larrys
setup.my.wd('paperfigs') # set working dir; UPDATE if this file moves, or if COPY/PASTE to new file
setup.my.knitr('Fig2-glue-figs-knitr/') # knitr's "unnamed-chunk-nnn" figures
my.figs.dir <- 'Fig2-glue-figs-mine/'   # my named figures
generic.setup(my.figs.dir)
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=2.9, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.8, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.7, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
height.a <- 2.3
height.b <- 1.9
pdf(fpath('Fig2'),width=6.5, height=height.a+height.b)
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.2,0.2), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=c(height.a, height.b))
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.3, 1.9) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.4, 1.8) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.6, 1.7) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.6, 1.75) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.6, 1.8) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
heights.a.b <- c(2.7, 1.8) # panel heights (inches)
pdf(fpath('Fig2'),width=6.5, height=sum(heights.a.b))
opar <- par(no.readonly=TRUE, oma=c(0,0,0,0), mar=c(3,3,0.4,0.4), tcl=-0.2)
layout(matrix(1:2,nrow=2), heights=heights.a.b)
# Fig 2A:
draw.des.fig(des, all.n.na, width=chr1.len, row.order=strain.order, panel.label='A', chr='Chr1',
xlab='Chromosome 1 Position (Mb)', gap.col = 'gold', d.col='dodgerblue2',
min.des=10000, twotone='lightblue', do.par=FALSE)
# Fig 2B:
xx <- snp.rates.plot(snp.rates.blob, des.col='blue3', undes.col='black', yclip=0.01, legend='',
xlab='Desert Index', ylab='SNP Density', main='',
ylab.sub=list(text='(SNPS / bp)', line=1.1, cex=.75),
yticks=list(padj=1.6, at=seq(0,0.01,0.0025),
labels=c('0.000','','0.005','','0.010'), cex=.9))
# panel='B':
text(0.62,0.0092,'B',cex=1.1) # for 2B, coords empirically set to roughly match rel pos in panel 2A
dev.off()
par(opar)
install.packages(c("evaluate", "htmlwidgets", "httpuv", "Rcpp"))
install.packages("compactr")
